<html>
	<head>
		<title>Tool Lending</title>
		<script type="text/javascript" src="js/ICanHaz.js"></script> 
		<script src='http://api.tiles.mapbox.com/mapbox.js/v1.0.0/mapbox.js'></script>
		<script src='js/jquery.js '></script>
		<script type="text/javascript" src='js/d3.js'></script>
		<script type="text/javascript" src='js/sheetsee.js'></script>
		<link rel="shortcut icon" href="https://raw.github.com/jllord/sheetsee-cache/master/favicon-p.png"/>


    <link href='http://api.tiles.mapbox.com/mapbox.js/v1.0.0/mapbox.css' rel='stylesheet' />
		<link media="screen" rel="stylesheet" type="text/css" href="/css/style.css"> 
		<link media="screen" rel="stylesheet" type="text/css" href="/css/site.css">
	</head>
<body>
	<div id="wrapper">
		<h1>Tool Lending!</h1>
		<small><a href="https://docs.google.com/spreadsheet/ccc?key=0AvFUWxii39gXdGxhcjhzYzlBX2pyVFZZU2VjZ3BHZ3c&usp=sharing" target="_blank">data source</a></small>
		<!-- <div id="map" class="container"></div> -->
		<!-- <span id="sortChart" class="button"> Sort values</span> -->
		<h3>Da Tools</h3>
		<div class="container">
			<h6 class="fleft"><input type="checkbox" id="available-tools-checked">Show only available tools</h6>
			<div class="flilter-container fright">
				<h6 class="fleft">Search for</h6>
				<input id="toolFilter" type="text" placeholder="hammer.."></input>
				<span class="clear sml-button">Clear</span>
				<span class="noMatches">no matches</span>
			</div>
		</div>
		<div id="toolTable" class="container"></div>
		<div id="info">
			<div class="span1">
				<p>This</p>
			</div>
		</div>
	
	</div><!-- end wrapper -->

	<script id="toolTable" type="text/html">
		<table>
		<tr>
			<th><span class="sml-button tHeader sortable">Tool</span></th>
			<th><span class="sml-button tHeader sortable">Owner</span></th>
			<th><span class="sml-button">Location</span></th>
		</tr>
		  {{#rows}}
		  	<tr class="table-stripe {{checkedout}} {{rowNumber}}"><td>{{tool}}</td><td><a href="mailto:{{owneremail}}?subject=Tool Lending: {{tool}}">{{owner}}</a></td><td>{{street}}, {{city}}, {{state}}</td><td class="borrow"><span class="sml-button">Borrow!</span></td></tr>
		  {{/rows}}
	  </table>
	</script>

	<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', function() { 
  	Sheetsee.makeTable(gData, "#toolTable")
  	Sheetsee.initiateTableFilter(gData, "#toolFilter", "#toolTable")
   }) 
	</script>

	<script type='text/javascript'>	
	// Sheetsee.geoCodeAddresses(gData)
  //   var optionsJSON = ["street", "city", "state"]
  //   var geoJSON = Sheetsee.createGeoJSON(gData, optionsJSON)
		// var map = Sheetsee.loadMap("map")
		// Sheetsee.addTileLayer(map, 'examples.map-20v6611k')
		// var markerLayer = Sheetsee.addMarkerLayer(geoJSON, map, 11)
		// addPopups(map, markerLayer)

		// function addPopups(map, markerLayer) {
		//   markerLayer.on('click', function(e) {
		//     var feature = e.layer.feature
		//     var popupContent = '<h2>' + feature.opts.street + '</h2>' +
		//                         '<h3>' + feature.opts.city + '</h3>'
		//     e.layer.bindPopup(popupContent,{closeButton: false,})
		//   })
		// }

	$('#available-tools-checked').bind("change", function() {
      if ($(this).attr('checked')) {
      	$(this).attr('checked', 'checked')
      	var availableTools = Sheetsee.getMatches(gData, "no", "checkedout")
      	Sheetsee.makeTable(availableTools, "#toolTable")
      	Sheetsee.initiateTableFilter(availableTools, "#toolFilter", "#toolTable")
    	}
    	else {
    		$(this).removeAttr('checked')
      	Sheetsee.makeTable(gData, "#toolTable")
      	Sheetsee.initiateTableFilter(gData, "#toolFilter", "#toolTable")
    	}
  })
	</script>


</body>
</html>